type hal_trust_default, domain;
hwbinder_use(hal_trust_default)
vndbinder_use(hal_trust_default)

type hal_trust_default_exec, exec_type, vendor_file_type, file_type;
init_daemon_domain(hal_trust_default)

# Check if hwservicemanager is ready
get_prop(hal_trust_default, hwservicemanager_prop)

# Add vendor.lineage.trust::IUsbRestrict service to hwservicemanager
add_hwservice(hal_trust_default, hal_lineage_trust_hwservice)

allow hal_trust_default self:capability sys_admin;

type hal_trust_file, file_type, fs_type, proc_type;
allow hal_trust_default hal_trust_file:file rw_file_perms;
